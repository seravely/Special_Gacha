<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ê´€ë¦¬ì ë¡œê·¸</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    h1 { margin-bottom: 10px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; }
    th, td { border: 1px solid #ccc; padding: 6px 8px; font-size: 13px; }
    th { background: #f0f0f0; }
    button { padding: 6px 10px; }
  </style>
</head>
<body>

<h1>ğŸ“Š ê´€ë¦¬ì ë¡œê·¸</h1>

<div id="loginBox">
  <input id="email" type="email" placeholder="ê´€ë¦¬ì ì´ë©”ì¼" />
  <input id="password" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸" />
  <button onclick="login()">ë¡œê·¸ì¸</button>
  <p id="err" style="color:red;"></p>
</div>

<div id="content" style="display:none;">
  <button onclick="logout()">ë¡œê·¸ì•„ì›ƒ</button>

  <h2>Sessions</h2>
  <table id="sessions"></table>

  <h2>Boards</h2>
  <table id="boards"></table>

  <h2>Draws</h2>
  <table id="draws"></table>
</div>

<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
  import { getAuth, signInWithEmailAndPassword, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "ë„¤ apiKey",
    authDomain: "ë„¤ authDomain",
    projectId: "ë„¤ projectId",
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  window.login = async () => {
    try {
      await signInWithEmailAndPassword(
        auth,
        email.value,
        password.value
      );
      loginBox.style.display = "none";
      content.style.display = "block";
      loadAll();
    } catch (e) {
      err.textContent = e.message;
    }
  };

  window.logout = async () => {
    await signOut(auth);
    location.reload();
  };

  async function render(colName, tableId) {
    const snap = await getDocs(collection(db, colName));
    const table = document.getElementById(tableId);
    table.innerHTML = "";

    if (snap.empty) {
      table.innerHTML = "<tr><td>ë°ì´í„° ì—†ìŒ</td></tr>";
      return;
    }

    const keys = Object.keys(snap.docs[0].data());
    table.innerHTML =
      "<tr>" + keys.map(k => `<th>${k}</th>`).join("") + "</tr>";

    snap.forEach(doc => {
      const d = doc.data();
      table.innerHTML +=
        "<tr>" + keys.map(k => `<td>${d[k]}</td>`).join("") + "</tr>";
    });
  }

  function loadAll() {
    render("sessions", "sessions");
    render("boards", "boards");
    render("draws", "draws");
  }
</script>

</body>
</html>
